

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CPyMad implementation &mdash; PyMad v0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyMad v0.2.0 documentation" href="../index.html" />
    <link rel="prev" title="PyMad API" href="../api/index.html" /> 
  </head>
  <body> 

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/pymad-logo-text.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api/index.html" title="PyMad API"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">CPyMad implementation</a><ul>
<li><a class="reference internal" href="#module-cern-madx">Module cern.madx</a><ul>
<li><a class="reference internal" href="#automatic-documentation">Automatic documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-cern-cpymad-model">Module cern.cpymad.model</a><ul>
<li><a class="reference internal" href="#id1">Automatic documentation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../api/index.html"
                        title="previous chapter">PyMad API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/cpymad/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="cpymad-implementation">
<h1>CPyMad implementation<a class="headerlink" href="#cpymad-implementation" title="Permalink to this headline">¶</a></h1>
<p>CPyMad is designed for two use-cases.</p>
<ul class="simple">
<li>The first is as a replacement for
the Mad-X interpreter, where function calls are pretty much the same, but
are converted to Python-like syntax. The module is called <tt class="xref py py-class docutils literal"><span class="pre">cern.madx</span></tt>.</li>
<li>The second is a model object, which is built on top of the new Mad-X interface.
The model object is aimed to be using model definitions from JMad, where all the
preliminary setup for a given machine is defined in built-in files, including knowledge
about available optics, strength files to use for each etc. The module is called
<tt class="xref py py-class docutils literal"><span class="pre">cern.cpymad.model</span></tt></li>
</ul>
<div class="section" id="module-cern-madx">
<h2>Module cern.madx<a class="headerlink" href="#module-cern-madx" title="Permalink to this headline">¶</a></h2>
<p>This module aims to provide the full functionality of the Mad-X library in a more
convenient Python environment. As an example, when you call twiss/aperture/survey etc,
you immediately retrieve a functional Python object containing the information from the
table generated. Further, we try to reduce the amount of commands needed by combining
e.g. use, select, and twiss into the twiss function itself, and define reasonable default
patterns/columns etc.</p>
<p>A simple use case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cern</span> <span class="kn">import</span> <span class="n">madx</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="n">m</span><span class="o">=</span><span class="n">madx</span><span class="o">.</span><span class="n">madx</span><span class="p">()</span>

<span class="n">m</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;my-sequences.seq&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;my-strengths.str&#39;</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s">&#39;beam,sequence=myseq1,particle=PROTON&#39;</span><span class="p">)</span>

<span class="n">tw</span><span class="p">,</span><span class="n">summary</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">twiss</span><span class="p">(</span><span class="s">&#39;myseq1&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;betx&#39;</span><span class="p">])</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tw</span><span class="o">.</span><span class="n">s</span><span class="p">,</span><span class="n">tw</span><span class="o">.</span><span class="n">betx</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example we assume that you have a file containing the Mad-X commands to set up the sequence
and the strengths for your optics. You can then use <tt class="xref py py-meth docutils literal"><span class="pre">call()</span></tt> for which
the syntax should be understandable for a Mad-X user.</p>
<p>For anything not yet implemented in <tt class="xref py py-class docutils literal"><span class="pre">cern.madx.madx</span></tt>,
the <tt class="xref py py-meth docutils literal"><span class="pre">command()</span></tt> function is there. You can give any normal
Mad-X like command to this function. If you forget the <strong>;</strong> at the end, it will be
automatically added. In the example it is used to set the beam.</p>
<p>Finally we call twiss. If we do not give a pattern, &#8216;full&#8217; is chosen by default. Columns are also optional,
but it is recommended to set them for speed improvement. Currently the table is first written to file and then
parsed into a dictionary-like Python object. Each column in the table containing numerical data are in the form
of numpy.array() objects, while strings are simple lists.</p>
<p>Finally we choose another library to plot the result, in this case <tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.pyplot.plot()</span></tt>.</p>
<div class="section" id="automatic-documentation">
<h3>Automatic documentation<a class="headerlink" href="#automatic-documentation" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="module-cern-cpymad-model">
<h2>Module cern.cpymad.model<a class="headerlink" href="#module-cern-cpymad-model" title="Permalink to this headline">¶</a></h2>
<p>This module is an implementation of the abstract class
<a class="reference internal" href="../api/index.html#module-cern.pymad.abc.model" title="cern.pymad.abc.model"><tt class="xref py py-class docutils literal"><span class="pre">cern.pymad.abc.model</span></tt></a>, using <tt class="xref py py-class docutils literal"><span class="pre">cern.madx</span></tt> as the backend.</p>
<p>A simple use-case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cern</span> <span class="kn">import</span> <span class="n">cpymad</span>
<span class="n">m</span><span class="o">=</span><span class="n">cpymad</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s">&#39;lhc&#39;</span><span class="p">)</span>
<span class="n">tw</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">twiss</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;max/min beta x:&quot;</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">tw</span><span class="o">.</span><span class="n">betx</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">tw</span><span class="o">.</span><span class="n">betx</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Automatic documentation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api/index.html" title="PyMad API"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Y.I. Levinsen, K. Fuchsberger (CERN) .
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>